(this.webpackJsonpv2=this.webpackJsonpv2||[]).push([[0],{17:function(e,t,n){e.exports=n(26)},22:function(e,t,n){},23:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var o,i=n(0),r=n.n(i),a=n(16),s=n.n(a),l=(n(22),n(23),n(5)),c=n.n(l),u=n(11),f=n(4),d=n(7),h=n(6),g=n(9);function v(e){var t=(e&o.Right)===o.Right,n=(e&o.Left)===o.Left,i=(e&o.Down)===o.Down,r=(e&o.Up)===o.Up;return{isRight:t,isLeft:n,isDown:i,isUp:r,isDiagonal:(r||i)&&(t||n),isHorizontal:(t||n)&&!(r||i),isVertical:(r||i)&&!(t||n)}}function m(e){var t=v(e);return(t.isUp?"up":"")+(t.isDown?"down":"")+(t.isRight?"right":"")+(t.isLeft?"left":"")}function p(e){var t=function(e){return"(".concat(e.x,", ").concat(e.y,")")};return Array.isArray(e)?"[".concat(e.map(t).join(", "),"]"):t(e)}!function(e){e[e.None=0]="None",e[e.Right=1]="Right",e[e.Left=2]="Left",e[e.Down=4]="Down",e[e.Up=8]="Up"}(o||(o={}));var y;!function(e){e[e.None=0]="None",e[e.Verbose=1]="Verbose",e[e.Debug=2]="Debug",e[e.Info=3]="Info",e[e.Warning=4]="Warning",e[e.Error=5]="Error"}(y||(y={}));var b=new(function(){function e(){Object(f.a)(this,e),this.MIN_LEVEL=y.Debug}return Object(h.a)(e,[{key:"group",value:function(e){console.groupCollapsed(e)}},{key:"groupEnd",value:function(){console.groupEnd()}},{key:"v",value:function(e){if(this.MIN_LEVEL==y.Verbose){for(var t,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(t=console).debug.apply(t,[e].concat(o))}}},{key:"d",value:function(e){if(this.MIN_LEVEL!==y.None&&this.MIN_LEVEL<=y.Debug){for(var t,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(t=console).debug.apply(t,[e].concat(o))}}},{key:"i",value:function(e){for(var t,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.MIN_LEVEL!==y.None&&this.MIN_LEVEL<=y.Info&&(t=console).info.apply(t,[e].concat(o))}},{key:"w",value:function(e){for(var t,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.MIN_LEVEL!==y.None&&this.MIN_LEVEL<=y.Warning&&(t=console).warn.apply(t,[e].concat(o))}},{key:"e",value:function(e){for(var t,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.MIN_LEVEL!==y.None&&(t=console).error.apply(t,[e].concat(o))}},{key:"minLevel",get:function(){return y[this.MIN_LEVEL]}}]),e}());function E(e){b.MIN_LEVEL=e}var w=b,L=function(){var e=Array(),t=Array().concat(Array(3).fill(o.Right),Array(3).fill(o.Down),Array(3).fill(o.Right),Array(3).fill(o.Down),Array(3).fill(o.Left),Array(3).fill(o.Down),Array(3).fill(o.Left),Array(3).fill(o.Up),Array(3).fill(o.Left),Array(3).fill(o.Up),Array(3).fill(o.Right),Array(3).fill(o.Up)),n=-2,i=-5;return t.forEach((function(t){e.push({x:n,y:i});var o=v(t),r=o.isLeft,a=o.isRight,s=o.isDown,l=o.isUp;n=a?n+1===0?1:n+1:r?n-1===0?-1:n-1:n,i=s?i+1===0?1:i+1:l?i-1===0?-1:i-1:i})),e}();function O(e){var t=v(e);return t.isHorizontal&&t.isRight?0:t.isRight&&t.isDown?45:t.isVertical&&t.isDown?90:t.isLeft&&t.isDown?135:t.isHorizontal&&t.isLeft?180:t.isLeft&&t.isUp?225:t.isVertical&&t.isUp?270:t.isRight&&t.isUp?315:NaN}function x(e,t){if(e===t)return!0;var n=[v(e),v(t)],o=n[0],i=n[1];return!(!o.isVertical||!i.isVertical)||(!(!o.isHorizontal||!i.isHorizontal)||(!!(o.isRight&&o.isUp&&i.isLeft&&i.isDown)||(!!(i.isRight&&i.isUp&&o.isLeft&&o.isDown)||(!!(o.isLeft&&o.isUp&&i.isRight&&i.isDown)||!!(i.isLeft&&i.isUp&&o.isRight&&o.isDown)))))}function C(e,t){var n=v(t),o=e.x,i=e.y;return n.isUp&&(i=j(i,1)),n.isDown&&(i=j(i,-1)),n.isRight&&(o=j(o,1)),n.isLeft&&(o=j(o,-1)),{x:o,y:i}}function j(e,t){return e+t===0?j(e+t,t):e+t}!function(){var e=Object(g.a)(L),t=e.map((function(e){var t=e.x;e.y;return t})),n=e.map((function(e){e.x;return e.y})),o=Math.min.apply(Math,Object(g.a)(t))-5,i=Math.max.apply(Math,Object(g.a)(t))+5,r=Math.min.apply(Math,Object(g.a)(n))-5,a=Math.max.apply(Math,Object(g.a)(n))+5;console.debug("Creating a matrix from [%o, %o] to [%o, %o]",o,r,i,a);for(var s=function(t){for(var n=function(n){e.some((function(e){var o=e.x,i=e.y;return o===t&&i===n}))||e.push({x:t,y:n})},o=r;o<a;o++)n(o)},l=o;l<i;l++)s(l)}();var k=n(1),A=function e(t){Object(f.a)(this,e),this.coords=t,this.isOpened=!1,this.tdRef=void 0,this.lineDirections=Array()};A.prototype.toString=function(){return"".concat(this.isOpened?"Opened":"Closed"," cell ").concat(p(this.coords)," (dir=").concat(this.lineDirections.map((function(e){return m(e)})).join(", "),")")},Object(k.j)(A,{isOpened:k.o,lineDirections:k.o});var D=A,M=n(3),N=Object(M.a)((function(e){var t=e.game,n=e.model,o=(t.lines,n.dimensions);return r.a.createElement("div",{style:{left:o.offsetX,width:o.lengthPx,height:3,top:o.offsetY,transformOrigin:n.transformOrigin,transform:"rotate(".concat(o.rotationDeg,"deg)"),position:"absolute"}},r.a.createElement("div",{style:{animationName:"grow",opacity:.75,animationDuration:"1s",animationTimingFunction:"cubiz-bezier(0, 20, 50, 90)",background:"green",height:3}}))})),R=function(){function e(t,n){Object(f.a)(this,e),this.coords=t,this.game=n,this.direction=void 0,this.firstCell=void 0,this.lastCell=void 0,this.direction=function(e,t){var n=o.None;return e.x<t.x?n|=o.Right:e.x>t.x&&(n|=o.Left),e.y<t.y?n|=o.Up:e.y>t.y&&(n|=o.Down),n}(t[0],t[1]),this.firstCell=this.game.cellAt(this.coords[0].x,this.coords[0].y),this.lastCell=this.game.cellAt(this.coords[this.coords.length-1].x,this.coords[this.coords.length-1].y)}return Object(h.a)(e,[{key:"transformOrigin",get:function(){var e=v(this.direction);return e.isDiagonal||e.isHorizontal?"0 50%":e.isVertical?"0 100%":void 0}},{key:"dimensions",get:function(){var e=v(this.direction),t=this.firstCell.tdRef.current,n=this.lastCell.tdRef.current,o=t.offsetWidth,i=t.offsetHeight,r=0,a=0,s=0;if(e.isHorizontal)a=t.offsetTop+i/2-1.5,e.isRight?(s=Math.abs(t.offsetLeft-n.offsetLeft)+.5*o,r=t.offsetLeft+.25*o):(s=Math.abs(n.offsetLeft-t.offsetLeft)+.5*o,r=t.offsetLeft+.75*o);else if(e.isVertical){r=t.offsetLeft+o/2+3/(e.isUp?2:-2),a=t.offsetTop+i*(e.isDown?.2:.8)-3;var l=n.offsetTop+i*(e.isUp?.2:.8)-3;s=Math.abs(l-a)}else{if(!e.isDiagonal)throw new Error("Invalid direction");var c=n.offsetLeft+(e.isLeft?0:o),u=n.offsetTop+(e.isUp?0:i);r=t.offsetLeft+(e.isRight?0:o),a=t.offsetTop+(e.isDown?0:i),s=Math.floor(Math.sqrt(Math.pow(Math.floor(c-r),2)+Math.pow(Math.ceil(u-a),2)))}return{offsetX:r,offsetY:a,lengthPx:s,rotationDeg:O(this.direction)}}}]),e}();Object(k.j)(R,{firstCell:k.o,lastCell:k.o,direction:k.o,dimensions:k.g,transformOrigin:k.g});var I,U=function(){function e(){var t=this;Object(f.a)(this,e),this.lines=Array(),this.selectedCellCoords=void 0,this.cells=Array();for(var n=9;n>=-9;n=j(n,-1))for(var o=-9;o<=9;o=j(o,1))this.cells.push(new D({x:o,y:n}));this.initiateBoardAsync().then((function(){var e=0;Object(k.f)((function(){e>t.lines.length&&(t.cells.forEach((function(e){return e.isOpened=!1})),t.initiateBoard()),t.lines.forEach((function(e){var n=e.coords,o=e.direction;n.forEach((function(e){var n=e.x,i=e.y,r=t.cellAt(n,i);r.isOpened||(r.isOpened=!0),r.lineDirections.some((function(e){return e===o}))||(r.lineDirections.push(o),w.d("Added direction (%o) to cell at %o",m(o),p(r.coords)))}))})),e=t.lines.length}))}))}return Object(h.a)(e,[{key:"highlightedCoords",get:function(){return this.selectedCellCoords?this.getPossibleLines(this.selectedCellCoords).map((function(e){return e.coords})).reduce((function(e,t){return e.concat(t)}),[]):[]}},{key:"lineCount",get:function(){var e;return(null===(e=this.lines)||void 0===e?void 0:e.length)||0}},{key:"endOfLineCoords",get:function(){return this.selectedCellCoords?this.getPossibleLines(this.selectedCellCoords).map((function(e){return e.coords[e.coords.length-1]})):[]}},{key:"rows",get:function(){var e=this,t=Array();return this.cells.slice().sort((function(e,t){return e.coords.x-t.coords.x})).slice().sort((function(e,t){return t.coords.y-e.coords.y})).forEach((function(n){var o=n.coords.y,i=t.find((function(e){return e.yIndex===o}));i?i.cells.push(n):t.push({yIndex:o,cells:[n],game:e})})),t}}]),Object(h.a)(e,[{key:"initiateBoard",value:function(){var e,t=Object(d.a)(L);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.cellAt(n.x,n.y).isOpened=!0}}catch(o){t.e(o)}finally{t.f()}}},{key:"initiateBoardAsync",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,n,o,i,r=this,a=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]?a[0]:8,n=Object(d.a)(L),e.prev=2,i=c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.value,e.next=3,new Promise((function(e){return setTimeout((function(){r.cellAt(n.x,n.y).isOpened=!0,e(!0)}),t)}));case 3:case"end":return e.stop()}}),e)})),n.s();case 5:if((o=n.n()).done){e.next=9;break}return e.delegateYield(i(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),n.e(e.t1);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"cellAt",value:function(e,t){return this.cells.find((function(n){return n.coords.x===e&&n.coords.y===t}))}},{key:"getPossibleLines",value:function(e){var t=this,n=w.MIN_LEVEL;n<y.Info&&E(y.Info);var i,r=Array(),a=Object(d.a)([o.Up,o.Down,o.Left,o.Right,o.Up|o.Left,o.Up|o.Right,o.Down|o.Left,o.Down|o.Right]);try{var s=function(){for(var n=i.value,o=e.x,a=e.y,s=0,l=0,c=Array(),u=0;u<5;u++){var f;c.push({x:o,y:a});var d=t.cellAt(o,a);(null===d||void 0===d?void 0:d.isOpened)||l++,(null===d||void 0===d||null===(f=d.lineDirections)||void 0===f?void 0:f.some((function(e){return e===n||x(e,n)})))||s++;var h=C({x:o,y:a},n);o=h.x,a=h.y}if(5===s&&l<=1){var g=new R(c,t);w.i("Possible line from coords %s to direction %s: %s",p(e),m(n),p(c)),r.push(g)}};for(a.s();!(i=a.n()).done;)s()}catch(l){a.e(l)}finally{a.f()}return E(n),r}},{key:"tryCompleteLine",value:function(e){var t=this.selectedCellCoords;if(t){w.i("Attempting to complete line from %o to %o",p(t),p(e));var n,o=this.getLineForCoords(t,e),i=Object(d.a)(o.coords);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=r.x,s=r.y,l=this.cellAt(a,s);l.isOpened||(l.isOpened=!0,w.i("Opened cell at ",p(l.coords)))}}catch(c){i.e(c)}finally{i.f()}this.lines.push(o),w.d("Added line at %s. Line count: %o.",p(o.coords),this.lineCount),this.selectedCellCoords=void 0,w.d("Reset selected cell coords.")}else w.w("Could not complete line due to selected coords being falsy.")}},{key:"getLineForCoords",value:function(e,t){return this.getPossibleLines(e).find((function(e){return e.coords.some((function(e){return o=t,(n=e).x===o.x&&n.y===o.y;var n,o}))}))}}]),e}();U.origo={x:0,y:0},function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Finished=2]="Finished"}(I||(I={})),Object(k.j)(U,{selectedCellCoords:k.o,highlightedCoords:k.g,endOfLineCoords:k.g,lines:k.o,rows:k.g,cells:k.o,lineCount:k.g});var V=U;function _(e){var t,n=null===(t=e.game)||void 0===t?void 0:t.selectedCellCoords;return(null===n||void 0===n?void 0:n.x)===e.coords.x&&(null===n||void 0===n?void 0:n.y)===e.coords.y}var S=function(e,t,n,o){return{width:24,height:24,fontSize:t||e?14:12,textAlign:"center",backgroundColor:o?"rgb(90, 190, 150)":e&&!n?"red":e&&n?"rgb(103, 230, 123)":n?"rgb(90, 190, 150)":"#f9f9f9"}},z=Object(M.a)((function(e){var t=r.a.useRef(null),n=e.game,o=e.coords,i=e.coords,a=i.x,s=i.y,l=e.game.cellAt(a,s),c=e.game.highlightedCoords.some((function(e){return e.x===a&&e.y===s})),u=c&&n.endOfLineCoords.some((function(e){return e.x===a&&e.y===s}));return r.a.useEffect((function(){l&&(l.tdRef=t)}),[n,o,a,s]),r.a.createElement("td",{ref:t,className:"noselect cell ".concat("TODO"),style:S(_(e),l.isOpened,c,u),onClick:function(){var t,n;(null===(t=e.game.selectedCellCoords)||void 0===t?void 0:t.x)===a&&(null===(n=e.game.selectedCellCoords)||void 0===n?void 0:n.y)===s?e.game.selectedCellCoords=void 0:c?e.game.tryCompleteLine(e.coords):e.game.selectedCellCoords=e.coords},"data-coords":"[".concat(a,", ").concat(s,"]")},l.isOpened||_(e)?r.a.createElement(r.a.Fragment,null,"\u25cb"):r.a.createElement(r.a.Fragment,null,"\u2022"))})),H=function(e){return r.a.createElement("tr",null,e.cells.map((function(t){return r.a.createElement(z,Object.assign({game:e.game,key:t.coords.x},t))})))},P=n(13),T={minHeight:40,margin:"10px 5px"},B=function(e){return r.a.createElement("div",Object.assign({},e,{style:Object(P.a)({display:"flex"},e.style)}),e.children)},W=Object(M.a)((function(e){return r.a.createElement(B,{style:{margin:"auto",width:480,flexDirection:"column",background:"#eee"}},r.a.createElement(B,{style:{padding:"10px 25px 0 25px"}},r.a.createElement(B,{style:{flexGrow:1}},r.a.createElement("h1",null,"Linegame")),r.a.createElement(B,{style:{transform:"rotateZ(180deg)",paddingBottom:13}},r.a.createElement("h1",null,"Linegame"))),r.a.createElement(B,null,r.a.createElement(B,null,r.a.createElement("button",{style:T,onClick:function(){return Z()}},"Load")),r.a.createElement(B,null,r.a.createElement("button",{style:T,onClick:function(){return function(){var e=JSON.stringify(q.game.lines);localStorage.setItem("game_lines",e)}()}},"Save")),r.a.createElement(B,null,r.a.createElement("button",{style:T,onClick:function(){q.game=new V}},"New game"))),r.a.createElement(B,{style:{paddingBottom:20}},r.a.createElement(B,{style:{flexGrow:1}},r.a.createElement("button",{style:T,onClick:function(){b.MIN_LEVEL-1===-1?b.MIN_LEVEL=y.Error:b.MIN_LEVEL--}},"LogLevel-- (",w.minLevel,")")),r.a.createElement(B,{style:{flexGrow:1}},r.a.createElement("button",{style:T,onClick:function(){return e.game.lines.pop()}},"Undo \xab")),r.a.createElement(B,null,r.a.createElement("button",{style:T,onClick:function(){return Z()}},"How to Play"))),r.a.createElement(B,null,"Points: ",e.game.lineCount))})),F=n(12);var J=Object(M.a)((function(e){var t=e.game,n=e.tableRef,o=t.lines,a=r.a.useState({}),s=Object(F.a)(a,2),l=s[0],c=s[1],u=function(){var e="object"===typeof window;function t(){return{width:e?window.innerWidth:void 0,height:e?window.innerHeight:void 0}}var n=Object(i.useState)(t),o=Object(F.a)(n,2),r=o[0],a=o[1];return Object(i.useEffect)((function(){if(e)return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)};function n(){a(t())}}),[]),r}();return r.a.useEffect((function(){var e,t,o,i;c({width:null===n||void 0===n||null===(e=n.current)||void 0===e?void 0:e.offsetWidth,height:null===n||void 0===n||null===(t=n.current)||void 0===t?void 0:t.clientHeight,left:null===n||void 0===n||null===(o=n.current)||void 0===o?void 0:o.offsetLeft,top:null===n||void 0===n||null===(i=n.current)||void 0===i?void 0:i.offsetTop})}),[n,n.current,u]),r.a.createElement("div",{style:Object(P.a)({position:"absolute",background:"rgba(45,91,0,0.15)",top:0,left:0,pointerEvents:"none"},l)},Array.isArray(o)&&o.map((function(e,n){return r.a.createElement(N,{key:"line-".concat(n),model:e,game:t})})))})),G={width:480,margin:"auto"},Y=Object(M.a)((function(e){var t=e.game,n=r.a.useRef(null);return r.a.useEffect((function(){Object(k.f)((function(){console.debug("highlightedCoords: ",t.highlightedCoords)}))}),[t]),r.a.createElement("div",{style:{display:"relative"}},r.a.createElement(W,{game:t}),r.a.createElement("table",{ref:n,cellSpacing:1,style:G},r.a.createElement("tbody",null,t.rows.map((function(e){return r.a.createElement(H,Object.assign({game:t,key:e.yIndex},e))})))),r.a.createElement(J,{game:t,tableRef:n}))})),X=function e(){Object(f.a)(this,e),this.game=new V};Object(k.j)(X,{game:k.o});var q=new X;function Z(){return $.apply(this,arguments)}function $(){return($=Object(u.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("game_lines"))){e.next=13;break}return e.prev=2,n=JSON.parse(t),q.game.lines.splice(0,q.game.lines.length),q.game=new V,n.forEach((function(e){e=new R(e.coords,q.game),q.game.lines.push(e)})),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",!1);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}var K=Object(M.a)((function(){return r.a.createElement(Y,{game:q.game})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(K,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[17,1,2]]]);
//# sourceMappingURL=main.fa9a3f9f.chunk.js.map